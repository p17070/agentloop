<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgentLoop â€” Model Arena</title>
  <link rel="stylesheet" href="ab-test.css">
  <script src="https://cdn.jsdelivr.net/npm/marked@14/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/styles/github-dark.min.css" id="hljs-theme">
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
</head>
<body>
  <!-- Top Bar -->
  <header class="topbar">
    <div class="topbar-left">
      <a href="../" class="back-link" title="Back to Chat">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5"/><polyline points="12 19 5 12 12 5"/></svg>
      </a>
      <h1 class="logo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
        Model Arena
      </h1>
    </div>
    <div class="topbar-center">
      <div class="mode-tabs">
        <button class="mode-tab active" data-mode="side-by-side">Side by Side</button>
        <button class="mode-tab" data-mode="blind">Blind Test</button>
      </div>
    </div>
    <div class="topbar-right">
      <button id="history-btn" class="icon-btn" title="Test History">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        <span id="history-count" class="badge"></span>
      </button>
      <button id="theme-toggle" class="icon-btn" title="Toggle theme">
        <svg id="theme-icon-dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        <svg id="theme-icon-light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
      </button>
    </div>
  </header>

  <!-- Model Slots Config (dynamically populated) -->
  <div class="config-panel" id="config-panel">
    <!-- Populated by JS -->
  </div>

  <!-- System Message (shared) -->
  <div class="system-msg-bar">
    <button id="system-msg-toggle" class="system-msg-toggle">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
      System Message
      <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </button>
    <div id="system-msg-panel" class="system-msg-panel" style="display:none">
      <textarea id="system-msg" rows="3" placeholder="You are a helpful assistant."></textarea>
    </div>
  </div>

  <!-- Arena (dynamically populated N-pane grid) -->
  <div class="arena" id="arena">
    <!-- Populated by JS -->
  </div>

  <!-- Verdict Bar -->
  <div class="verdict-bar" id="verdict-bar" style="display:none">
    <div class="verdict-prompt">Which response is best?</div>
    <div class="verdict-buttons" id="verdict-buttons">
      <!-- Populated by JS -->
    </div>
  </div>

  <!-- Metrics Table -->
  <div class="metrics-bar" id="metrics-bar" style="display:none">
    <table class="metrics-table" id="metrics-table">
      <!-- Populated by JS -->
    </table>
  </div>

  <!-- Input Area -->
  <div class="input-area">
    <div class="input-container">
      <textarea id="user-input" rows="1" placeholder="Send the same prompt to all models..." autofocus></textarea>
      <button id="send-btn" class="send-btn" title="Send to all models (Enter)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
      </button>
      <button id="stop-btn" class="send-btn stop-btn" title="Stop generation" style="display:none">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
      </button>
    </div>
    <div class="input-footer">
      <span class="muted" id="slot-count-label">Same prompt sent to 2 models simultaneously</span>
      <button id="clear-btn" class="text-btn" title="Clear arena">Clear</button>
    </div>
  </div>

  <!-- History Drawer -->
  <div id="history-overlay" class="history-overlay" style="display:none">
    <div class="history-drawer">
      <div class="history-header">
        <h2>Test History</h2>
        <div class="history-actions">
          <button id="export-history-btn" class="icon-btn" title="Export as JSON">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          </button>
          <button id="clear-history-btn" class="icon-btn" title="Clear all history">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
          </button>
          <button id="history-close" class="icon-btn" title="Close">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
      </div>
      <div class="history-summary" id="history-summary"></div>
      <div class="history-list" id="history-list"></div>
    </div>
  </div>

  <script src="../catalog.generated.js"></script>
  <script src="../providers.js"></script>
  <script src="ab-test.js"></script>
</body>
</html>
